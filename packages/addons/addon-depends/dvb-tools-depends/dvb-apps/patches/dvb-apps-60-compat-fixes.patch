From e6ff7da39edd44fe6bb14bcba29c0fc5a02957a8 Mon Sep 17 00:00:00 2001
From: CrazyCat <crazycat69@narod.ru>
Date: Sun, 20 May 2018 21:22:24 +0300
Subject: [PATCH] Some compat fixes.

---
 lib/libdvbapi/dvbnet.c   | 4 ++++
 lib/libdvbapi/dvbvideo.c | 1 -
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/lib/libdvbapi/dvbnet.c b/lib/libdvbapi/dvbnet.c
index 25c09ad..7ddaabe 100644
--- a/lib/libdvbapi/dvbnet.c
+++ b/lib/libdvbapi/dvbnet.c
@@ -29,6 +29,10 @@
 #include <errno.h>
 #include "dvbnet.h"
 
+#ifndef DVB_NET_FEEDTYPE_GSE
+#define DVB_NET_FEEDTYPE_GSE 2  /* generic stream  encapsulation */
+#endif
+
 int dvbnet_open(int adapter, int netdeviceid)
 {
 	char filename[PATH_MAX+1];
diff --git a/lib/libdvbapi/dvbvideo.c b/lib/libdvbapi/dvbvideo.c
index f1ffbe8..18a4d3a 100644
--- a/lib/libdvbapi/dvbvideo.c
+++ b/lib/libdvbapi/dvbvideo.c
@@ -26,7 +26,6 @@
 #include <unistd.h>
 #include <sys/ioctl.h>
 #include <linux/types.h>
-#include <linux/dvb/video.h>
 #include <errno.h>
 #include "dvbvideo.h"
 
--- a/lib/libdvbapi/dvbaudio.c	2021-07-27 22:57:28.723492743 +1000
+++ b/lib/libdvbapi/dvbaudio.c	2021-07-27 23:07:08.672581030 +1000
@@ -25,10 +25,13 @@
 #include <fcntl.h>
 #include <unistd.h>
 #include <sys/ioctl.h>
-#include <linux/dvb/audio.h>
 #include <errno.h>
 #include "dvbaudio.h"
 
+#ifndef AUDIO_SET_BYPASS_MODE
+#define AUDIO_SET_BYPASS_MODE	_IO('o', 8)
+#endif
+
 int dvbaudio_open(int adapter, int audiodeviceid)
 {
 	char filename[PATH_MAX+1];
--- a/test/test_av.c	2021-07-27 23:11:51.105535377 +1000
+++ b/test/test_av.c	2021-07-27 23:12:05.035519211 +1000
@@ -31,8 +31,6 @@
 #include <unistd.h>
 
 #include <linux/types.h>
-#include <linux/dvb/audio.h>
-#include <linux/dvb/video.h>
 
 int audioStop(int fd, char *arg)
 {
--- a/util/szap/szap.c	2021-07-27 23:26:32.667530471 +1000
+++ b/util/szap/szap.c	2021-07-27 23:26:46.154138354 +1000
@@ -46,7 +46,6 @@
 
 #include <linux/dvb/frontend.h>
 #include <linux/dvb/dmx.h>
-#include <linux/dvb/audio.h>
 #include "lnb.h"
 #include "util.h"
 
@@ -57,6 +56,10 @@
 #define FALSE (1==0)
 #endif
 
+#ifndef AUDIO_SET_BYPASS_MODE
+#define AUDIO_SET_BYPASS_MODE  _IO('o', 8)
+#endif
+
 /* location of channel list file */
 #define CHANNEL_FILE "channels.conf"
 
